"use strict";(self.webpackChunkbitbom=self.webpackChunkbitbom||[]).push([[572],{682:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var s=i(4848),r=i(8453);const a={slug:"isolating-and-fixing-vulnerabilities-in-an-air-gapped-environment",title:"Isolating and Fixing Vulnerabilities in an Air-Gapped Environment",description:"How we isolated and fixed vulnerabilities in an air-gapped environment",keywords:["SBOM","dependency graphs","air-gapped","vulnerabilities"],authors:["BitBom"],tags:["air-gapped","vulnerabilities"]},t=void 0,l={permalink:"/blog/isolating-and-fixing-vulnerabilities-in-an-air-gapped-environment",source:"@site/blog/2024-10-25-Isolating-and-Fixing-Vulnerabilities-in-an-Air-Gapped-Environment/index.md",title:"Isolating and Fixing Vulnerabilities in an Air-Gapped Environment",description:"How we isolated and fixed vulnerabilities in an air-gapped environment",date:"2024-10-25T00:00:00.000Z",tags:[{inline:!0,label:"air-gapped",permalink:"/blog/tags/air-gapped"},{inline:!0,label:"vulnerabilities",permalink:"/blog/tags/vulnerabilities"}],readingTime:5.765,hasTruncateMarker:!0,authors:[{name:"BitBom",title:"Graphing SBOM's Fast",url:"https://github.com/bitbom",page:{permalink:"/blog/authors/bit-bom"},imageURL:"https://github.com/bitbomdev.png",key:"BitBom"}],frontMatter:{slug:"isolating-and-fixing-vulnerabilities-in-an-air-gapped-environment",title:"Isolating and Fixing Vulnerabilities in an Air-Gapped Environment",description:"How we isolated and fixed vulnerabilities in an air-gapped environment",keywords:["SBOM","dependency graphs","air-gapped","vulnerabilities"],authors:["BitBom"],tags:["air-gapped","vulnerabilities"]},unlisted:!1,nextItem:{title:"How Minefield Enables Air-Gapped SBOM Vulnerability Graphing Like Git's Disconnected Mode",permalink:"/blog/Air-Gapped-Vulnerability"}},d={authorsImageUrls:[void 0]},o=[{value:"Introduction",id:"introduction",level:2},{value:"The Foundation: Instantaneous Queries",id:"the-foundation-instantaneous-queries",level:2},{value:"Bitwise Operations: Combining Queries for Greater Insight",id:"bitwise-operations-combining-queries-for-greater-insight",level:2},{value:"A Story of Finding and Eliminating Vulnerabilities",id:"a-story-of-finding-and-eliminating-vulnerabilities",level:2},{value:"The Vulnerability Alert",id:"the-vulnerability-alert",level:3},{value:"Step 1: Identifying Affected Dependencies",id:"step-1-identifying-affected-dependencies",level:4},{value:"Step 2: Assessing the Impact",id:"step-2-assessing-the-impact",level:4},{value:"Step 3: Prioritizing the Fix",id:"step-3-prioritizing-the-fix",level:4},{value:"Step 4: Fixing the rest of the graph",id:"step-4-fixing-the-rest-of-the-graph",level:3},{value:"What\u2019s Up Coming",id:"whats-up-coming",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Isolating and Identifying Critical Vulnerabilities in under 5 minutes (coffee break ;))"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"TL;DR"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Minefield simplifies the process of discovering and addressing vulnerabilities across complex software projects by using fast, bitwise queries and Roaring Bitmaps to analyze Software Bill of Materials (SBOMs) in air-gapped environments. With straightforward commands, you can quickly identify affected packages, assess their impact, prioritize fixes for critical components, and systematically eliminate risks. Soon, an integrated Language Learning Model (LLM) will make writing these queries even easier, enabling more intuitive and efficient security management without compromising on safety."})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(n.p,{children:["Imagine you're managing a complex software project with thousands of dependencies. One day, researchers discover a critical vulnerability in a popular library. How quickly can you determine if your project is affected? How do you identify all the dependencies that rely on this vulnerable library? Enter ",(0,s.jsx)(n.a,{href:"https://github.com/bitbomdev/minefield",children:"Minefield"})," an air-gapped solution for analyzing Software Bill of Materials (SBOMs). By leveraging the power of ",(0,s.jsx)(n.a,{href:"https://github.com/RoaringBitmap/roaring",children:"Roaring Bitmaps"})," and bitwise queries, Minefield enables you to perform lightning-fast analyses, uncovering deep insights into your software dependencies with remarkable efficiency."]}),"\n",(0,s.jsx)(n.h2,{id:"the-foundation-instantaneous-queries",children:"The Foundation: Instantaneous Queries"}),"\n",(0,s.jsxs)(n.p,{children:["Minefield's core capabilities are its basic queries for dependencies and dependents. Thanks to our ",(0,s.jsx)(n.a,{href:"https://github.com/bitbomdev/minefield/blob/main/pkg/graph/cache.go#L10",children:"cache"}),", these operations are ",(0,s.jsx)(n.code,{children:"O(1)"})," or instantaneous. This efficiency enables more complex analyses. It lets you quickly navigate vast dependency graphs."]}),"\n",(0,s.jsx)(n.h2,{id:"bitwise-operations-combining-queries-for-greater-insight",children:"Bitwise Operations: Combining Queries for Greater Insight"}),"\n",(0,s.jsxs)(n.p,{children:["The real magic happens when we combine these basic queries using bitwise operations. Since the result of every query is a roaring bitmap, we can perform operations like ",(0,s.jsx)(n.code,{children:"AND"}),", ",(0,s.jsx)(n.code,{children:"OR"}),", and ",(0,s.jsx)(n.code,{children:"XOR"})," on the results of multiple queries. This approach opens up many possibilities for analyzing software dependencies. It is especially useful for finding and fixing vulnerabilities."]}),"\n",(0,s.jsx)(n.h2,{id:"a-story-of-finding-and-eliminating-vulnerabilities",children:"A Story of Finding and Eliminating Vulnerabilities"}),"\n",(0,s.jsx)(n.p,{children:"Let's walk through a real-world scenario:"}),"\n",(0,s.jsx)(n.h3,{id:"the-vulnerability-alert",children:"The Vulnerability Alert"}),"\n",(0,s.jsxs)(n.p,{children:["Your security team alerts you to a critical vulnerability ",(0,s.jsx)(n.code,{children:"GHSA-1234"}),". You need to determine:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"How does the vulnerability affect your project?"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"How deeply ingrained is the vulnerable library in your dependency tree?"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"How can you isolate and address the vulnerability quickly?"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"step-1-identifying-affected-dependencies",children:"Step 1: Identifying Affected Dependencies"}),"\n",(0,s.jsx)(n.p,{children:"Our first concern is to find all the packages affected by this vulnerability."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\nminefield query custom "dependents library GHSA-1234"\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This query returns all packages in your graph that depend on ",(0,s.jsx)(n.code,{children:"GHSA-1234"}),", directly or transitively."]}),"\n",(0,s.jsx)(n.h4,{id:"step-2-assessing-the-impact",children:"Step 2: Assessing the Impact"}),"\n",(0,s.jsxs)(n.p,{children:["This is a critical vulnerability. Before solving all problems, we want to find what parts of your main critical packages are affected. For example, assume you own ",(0,s.jsx)(n.code,{children:"Kubernetes"})," which is your critical project. You want to know which ",(0,s.jsx)(n.code,{children:"Kubernetes"})," dependencies are affected by this vulnerability. This is your first priority."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\nminefield query custom "dependencies library pkg:kubernetes and dependents library GHSA-1234"\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This bitwise ",(0,s.jsx)(n.code,{children:"AND"})," narrows the list to only those ",(0,s.jsx)(n.code,{children:"Kubernetes"})," dependencies that rely on vulnerable libraries. This gives you a basic understanding of how severe this problem is for ",(0,s.jsx)(n.code,{children:"Kubernetes"}),". This query will give you a list of dependencies for ",(0,s.jsx)(n.code,{children:"Kubernetes"})," that are affected by this vulnerability."]}),"\n",(0,s.jsx)(n.h4,{id:"step-3-prioritizing-the-fix",children:"Step 3: Prioritizing the Fix"}),"\n",(0,s.jsxs)(n.p,{children:["Now that we have this list, we need to inform the engineering team which packages to focus on. Remember, we first want our main package, ",(0,s.jsx)(n.code,{children:"Kubernetes"}),", to be secure."]}),"\n",(0,s.jsxs)(n.p,{children:["Let's create a ranked list for the whole graph. It should rank packages by the number of their dependencies, affected by the vulnerability, that are dependencies of ",(0,s.jsx)(n.code,{children:"Kubernetes"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"This is a mouthful, so let's break it down."}),"\n",(0,s.jsxs)(n.p,{children:["Let's say we have packages ",(0,s.jsx)(n.code,{children:"A"}),", ",(0,s.jsx)(n.code,{children:"B"}),", and ",(0,s.jsx)(n.code,{children:"C"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Kubernetes"})," depends on ",(0,s.jsx)(n.code,{children:"A"})," and ",(0,s.jsx)(n.code,{children:"C"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"A"})," depends on ",(0,s.jsx)(n.code,{children:"B"})," and ",(0,s.jsx)(n.code,{children:"C"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Both ",(0,s.jsx)(n.code,{children:"A"})," and ",(0,s.jsx)(n.code,{children:"B"})," are affected by the vulnerability."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["So, package ",(0,s.jsx)(n.code,{children:"A"})," is the one vulnerable dependency and ",(0,s.jsx)(n.code,{children:"Kubernetes"})," dependency."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-mermaid",children:"graph TB;\n    subgraph MainPackage\n        A[Kubernetes]\n    end\n    A --\x3e B[Package A]\n    A --\x3e C[Package C]\n    B --\x3e D[Package B]\n    B --\x3e C\n    B:::vulnerable\n    D:::vulnerable\n\n    classDef vulnerable fill:#f96,stroke:#333,stroke-width:2px;\n\n    %% This diagram shows the relationships:\n    %% - Kubernetes depends on A and C.\n    %% - A depends on B and C.\n    %% - Both A and B are vulnerable.\n\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\nminefield leaderboard custom "dependencies library and (dependents library GHSA-1234 and dependencies library pkg:kubernetes)"\n\n'})}),"\n",(0,s.jsx)(n.p,{children:"This command shows a leaderboard of affected packages. It helps you prioritize which parts to fix first."}),"\n",(0,s.jsx)(n.h3,{id:"step-4-fixing-the-rest-of-the-graph",children:"Step 4: Fixing the rest of the graph"}),"\n",(0,s.jsx)(n.p,{children:"We fixed Kubernetes. Now, we need to find what to fix next. We want to run the previous query for all packages that are not Kubernetes dependencies."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\nminefield leaderboard custom "dependencies library and ((dependents library GHSA-1234 xor dependencies library pkg:Kubernetes ) and dependents library GHSA-1234)"\n\n'})}),"\n",(0,s.jsx)(n.p,{children:"Ok, so this is a little more complicated but still very close to the previous query, so let's break down the parenthesis."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"((dependents library GHSA-1234 xor dependencies library pkg:Kubernetes ) and dependents library GHSA-1234)"})}),"\n",(0,s.jsxs)(n.p,{children:["First, ",(0,s.jsx)(n.code,{children:"(dependents library GHSA-1234 xor dependencies library pkg:Kubernetes )"})," finds the unique elements of both queries. It means all the vulnerable libraries that are not dependencies of ",(0,s.jsx)(n.code,{children:"Kubernetes"})," are in this. It also includes all dependencies of ",(0,s.jsx)(n.code,{children:"Kubernetes"})," that are not affected by the vulnerability."]}),"\n",(0,s.jsxs)(n.p,{children:["The second part, ",(0,s.jsx)(n.code,{children:"and dependents library GHSA-1234"}),", isolates just the vulnerable packages from the first query. It throws away anything that was not a vulnerable library."]}),"\n",(0,s.jsxs)(n.p,{children:["At the we are end ranking all the packages in the graph by the number of dependencies that are affected by the vulnerabiltiy, that are not dependencies of ",(0,s.jsx)(n.code,{children:"Kubernentes"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"whats-up-coming",children:"What\u2019s Up Coming"}),"\n",(0,s.jsx)(n.p,{children:"While these queries are powerful, writing them repeatedly can become tedious. That\u2019s why we are developing a Large Language Model (LLM) to make this process smoother. Our goal is to simplify query creation, allowing you to interact with Minefield in a more natural, conversational way. This LLM will understand your needs and generate the necessary commands, saving you time and reducing the complexity of crafting intricate queries."}),"\n",(0,s.jsx)(n.p,{children:"Moreover, we plan to deploy this LLM in an air-gapped environment, ensuring that your data and analysis remain secure and isolated. This approach will maintain the high level of security Minefield is known for while enhancing its usability. Stay tuned for updates as we work towards making Minefield even more intuitive and efficient!"}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"In today's fast-paced development world, we must quickly find and fix vulnerabilities. Minefield's bitwise queries empower you to perform complex analyses with ease, enabling you to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Rapidly identify affected components when a vulnerability is discovered."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Analyze and compare different versions of your projects."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Perform intricate multi-step analyses for deep insights."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Minefield uses fast, roaring bitmaps and flexible bitwise ops. It opens new ways to understand and manage software dependencies in air-gapped environments. Whether you're safeguarding your projects against vulnerabilities or optimizing your dependency graph, Minefield equips you with the tools you need to maintain a robust and secure software ecosystem."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Ready to unleash the power of Minefield in your projects? Our docs explain how bitwise queries can improve your security and dependency management."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const r={},a=s.createContext(r);function t(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);